<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>论文查询平台 - Xiaoqi&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Xiaoqi&#039;s Blog"><meta name="msapplication-TileImage" content="https://file-1305436646.file.myqcloud.com/gh/gh-user.jpeg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Xiaoqi&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="又是很久都没有整理过了，这次也不立什么一定要坚持写博客的flag了。这一段时间忙了一些别的事情，技术上把Vue全家桶用于项目中实践了一下，也算是收获不少。"><meta property="og:type" content="blog"><meta property="og:title" content="论文查询平台"><meta property="og:url" content="http://example.com/%E8%AE%BA%E6%96%87%E6%9F%A5%E8%AF%A2%E5%B9%B3%E5%8F%B0/"><meta property="og:site_name" content="Xiaoqi&#039;s Blog"><meta property="og:description" content="又是很久都没有整理过了，这次也不立什么一定要坚持写博客的flag了。这一段时间忙了一些别的事情，技术上把Vue全家桶用于项目中实践了一下，也算是收获不少。"><meta property="og:image" content="https://file-1305436646.file.myqcloud.com/blog/2018-12-2/picture.jpg"><meta property="article:published_time" content="2018-12-02T14:51:20.000Z"><meta property="article:modified_time" content="2021-09-30T06:47:07.069Z"><meta property="article:author" content="xiaoqi"><meta property="article:tag" content="项目"><meta property="article:tag" content="Vue"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://file-1305436646.file.myqcloud.com/blog/2018-12-2/picture.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/%E8%AE%BA%E6%96%87%E6%9F%A5%E8%AF%A2%E5%B9%B3%E5%8F%B0/"},"headline":"论文查询平台","image":["https://file-1305436646.file.myqcloud.com/blog/2018-12-2/picture.jpg"],"datePublished":"2018-12-02T14:51:20.000Z","dateModified":"2021-09-30T06:47:07.069Z","author":{"@type":"Person","name":"xiaoqi"},"publisher":{"@type":"Organization","name":"Xiaoqi's Blog","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"又是很久都没有整理过了，这次也不立什么一定要坚持写博客的flag了。这一段时间忙了一些别的事情，技术上把Vue全家桶用于项目中实践了一下，也算是收获不少。"}</script><link rel="canonical" href="http://example.com/%E8%AE%BA%E6%96%87%E6%9F%A5%E8%AF%A2%E5%B9%B3%E5%8F%B0/"><link rel="icon" href="https://file-1305436646.file.myqcloud.com/gh/gh-user.jpeg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Xiaoqi&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catálogo" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Buscar" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Publicado hace&nbsp;<time dateTime="2018-12-02T14:51:20.000Z" title="2018/12/2 下午10:51:20">2018-12-02</time></span><span class="level-item">Actualizado hace&nbsp;<time dateTime="2021-09-30T06:47:07.069Z" title="2021/9/30 下午2:47:07">2021-09-30</time></span><span class="level-item"><a class="link-muted" href="/categories/%E9%A1%B9%E7%9B%AE/">项目</a></span><span class="level-item">33 minutes de lectura (Aproximadamente 4909 palabras)</span></div></div><h1 class="title is-3 is-size-4-mobile">论文查询平台</h1><div class="content"><p>又是很久都没有整理过了，这次也不立什么一定要坚持写博客的flag了。这一段时间忙了一些别的事情，技术上把Vue全家桶用于项目中实践了一下，也算是收获不少。</p>
<span id="more"></span>

<h2 id="大概需求"><a href="#大概需求" class="headerlink" title="大概需求"></a>大概需求</h2><p>先放一张大概效果图。</p>
<img src="https://file-1305436646.file.myqcloud.com/blog/2018-12-2/picture.jpg">

<p>需求简单点讲就是学科期刊，以及热点论文什么的查询。内容上分为六个模块，其中一个ESI学科期刊模块，两个顶级论文模块内容基本一样。查询时左侧会分别用关键词、月份、年份、学科进行过滤。然后还要支持导出excel，就是把数据整合成excel表格导出。</p>
<p>需求并不是很复杂，但是实际写的时候确实也是考虑了很多东西，算是在代码规范上更近了一步吧。</p>
<h2 id="结构设计"><a href="#结构设计" class="headerlink" title="结构设计"></a>结构设计</h2><h3 id="组件抽象"><a href="#组件抽象" class="headerlink" title="组件抽象"></a>组件抽象</h3><p>学科期刊和顶级论文这三个模块内容基本一致，返回数据不同，因此可以把他们归为一类。</p>
<h4 id="左侧过滤组件"><a href="#左侧过滤组件" class="headerlink" title="左侧过滤组件"></a>左侧过滤组件</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FilterForm</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">v-if</span>=<span class="string">&quot;isRenderTime&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">filterType</span>=<span class="string">&quot;timeMonth&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">ref</span>=<span class="string">&quot;checkedMonth&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:filterItems</span>=<span class="string">&quot;formData.filterMonth&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">give-conditions</span>=<span class="string">&quot;getArticaleData&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">FilterForm</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>左侧抽象出来过滤组件，其中关键词查询都有不用做过多抽象。</p>
<p>分类检索部分分三块，也可以抽象成一个小的过滤组件。通过父级组件传值<code>filterType</code>，来确定渲染成哪一部分的过滤模块</p>
<p>其中由于月份的显示方式不太一样，为了节省空间，一行放了两个。所以需要绑定一个特殊的class，再用一个计算属性<code>isMonth</code>来判断是否是月份过滤，来判断有<code>display: inline-block</code>的class是否显示该组件上</p>
<p>月份、年份、学科这三个过滤条件并不是每个页面都需要，因此根据获取的路由数据来判断哪一个过滤条件需要显示</p>
<p>由于点击一个过滤按钮，需要获取其所有兄弟过滤组件的选中数据，所以这里我通过在过滤组件点击时，向父级元素传递信号，然后在父级元素上通过ref获取了三个过滤组件的值。</p>
<h3 id="vuex数据管理"><a href="#vuex数据管理" class="headerlink" title="vuex数据管理"></a>vuex数据管理</h3><p>把Vuex的相关代码分割成了数个模块，便于管理。然后提交方式都是通过action异步提交（这样更规范一些？此处后面还需要深入理解一下）</p>
<p>查询里面的条件全部都用了Vuex来管理，<code>关键词</code>、<code>页码</code>、<code>月份</code>、<code>年份</code>、<code>学科</code>（此处可能还需要深入思考一下，<code>关键词</code>、<code>月份</code>、<code>年份</code>、<code>学科</code>这四个确实还有别的兄弟组件渲染的时候需要使用，但仅仅是读取并不会修改，放在Vuex里面管理代码方便了很多，但是究竟有没有更合适的方法还需要深入思考一下。但是<code>页码</code>这个并没有别的组件需要共享，放在里面纯属是因为和后台传参的时候直接读取Vuex的数据就行，图个方便，是否合理确实还要三思一下）</p>
<p>搜索结果，就是后端传回来的文章数据，我也把他放在了Vuex里面管理。当时想的是，获取结果有四种方式，分别是<code>页面跳转</code>、<code>关键词查询</code>、<code>过滤条件</code>、<code>页码</code>这四个部分需要从后端获取数据，后端返回数据以后直接分发提交到Vuex里面，然后页面直接响应式渲染出来（其实也是图个方便，而且也确实目前的水准想不出什么更好的方式来组织结构）。</p>
<p>文章下载全选功能，这个应该是用的比较的合适了。就是点击全选后，所有文章前面的多选框都要确定上，然后若某一个多选框取消了，全选前面的框也要取消。从这个角度看，双方共同维护这个选中的文章数组，两方都是可读可写，此处用的应该可以说是非常合适了。</p>
<p>因此，总结一下，Vuex用了之后非常的方便，但是也可能造成一些Vuex的滥用，目前也确实没有想到比较好的方式来管理，此处需要在项目结束之后深入思考一下。</p>
<h2 id="关于css"><a href="#关于css" class="headerlink" title="关于css"></a>关于css</h2><h3 id="css嵌套问题"><a href="#css嵌套问题" class="headerlink" title="css嵌套问题"></a>css嵌套问题</h3><p>之前为了图方便，往往把子元素都写在其父元素内，导致父元素的class拉的很长，这样一是不便查看，二是不便于组件复用（只有位于特定父元素下，该class才会生效，不便于复用）。<br>重构后，发现代码可读性并不是很高。于是再次重构，将联系紧密的嵌套一起，嵌套层数不超过2层，感觉可读性更强了一些。</p>
<p>还有css不要嵌套选择器，比如说导航  .list a  ，像这样可能会导致后面改动的问题，比如说list内又加了一个item，item里加了一个a，这时候就会影响到item a，不便于维护。</p>
<h3 id="将less的全局变量文件抽离"><a href="#将less的全局变量文件抽离" class="headerlink" title="将less的全局变量文件抽离"></a>将less的全局变量文件抽离</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 深灰</span></span><br><span class="line">@deep-grey: #e6e6e6;</span><br><span class="line"><span class="comment">// 浅灰</span></span><br><span class="line">@light-grey: #F1F1F1;</span><br><span class="line"><span class="comment">// 深色边框</span></span><br><span class="line">@border-deep: #bababa;</span><br><span class="line"><span class="comment">// 浅色边框</span></span><br><span class="line">@border-light: #d3d3d3;</span><br><span class="line"><span class="comment">// header底色</span></span><br><span class="line">@header-blue: #2a4c90;</span><br><span class="line"><span class="comment">// 字体颜色</span></span><br><span class="line">@font-color: #4b505a;</span><br><span class="line"><span class="comment">// 搜索结果面板背景</span></span><br><span class="line">@content-color: #f8f8f8;</span><br><span class="line"><span class="comment">// 按钮颜色</span></span><br><span class="line">@button-color: #e4e5ec;</span><br></pre></td></tr></table></figure>

<p>为了方便项目颜色的调整，很多时候取的颜色都是相同的，这里可以使用less的变量定义。但是这里如果每个vue文件都要引入一遍less文件，会很麻烦，也不方便维护。这里使用<code>style-resources-loader</code>插件来管理，npm安装好后，在vue.config.js里面配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">pluginOptions</span>: &#123;</span><br><span class="line">    <span class="comment">// 配置less全局变量</span></span><br><span class="line">    <span class="string">&quot;style-resources-loader&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">preProcessor</span>: <span class="string">&quot;less&quot;</span>,</span><br><span class="line">      <span class="attr">patterns</span>: [path.resolve(__dirname, <span class="string">&quot;src/global.less&quot;</span>)]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置好后，就可以直接在每个vue中使用了（此处需要研究一下原理）。</p>
<h2 id="axios二次封装"><a href="#axios二次封装" class="headerlink" title="axios二次封装"></a>axios二次封装</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="comment">// import qs from &quot;qs&quot;; // 序列化请求数据，视服务端的要求</span></span><br><span class="line"><span class="comment">// import router from &quot;../router&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Axios = axios.create(&#123;</span><br><span class="line">  <span class="attr">baseURL</span>: <span class="string">&quot;http://106.14.153.164:6374&quot;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">10000</span>,</span><br><span class="line">  <span class="attr">responseType</span>: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">  <span class="attr">withCredentials</span>: <span class="literal">false</span>, <span class="comment">// 是否允许带cookie这些</span></span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json;charset=utf-8&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//POST传参序列化(添加请求拦截器)</span></span><br><span class="line">Axios.interceptors.request.use(</span><br><span class="line">  <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 在发送请求之前做某件事</span></span><br><span class="line">    <span class="comment">// if (config.method === &quot;post&quot;) &#123;</span></span><br><span class="line">    <span class="comment">//   // 序列化</span></span><br><span class="line">    <span class="comment">//   config.data = qs.stringify(config.data);</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若是有做鉴权token , 就给头部带上token</span></span><br><span class="line">    <span class="comment">// 若是需要跨站点,存放到 cookie 会好一点,限制也没那么多,有些浏览环境限制了 localstorage 的使用</span></span><br><span class="line">    <span class="comment">// 这里localStorage一般是请求成功后我们自行写入到本地的,因为你放在vuex刷新就没了</span></span><br><span class="line">    <span class="comment">// 一些必要的数据写入本地,优先从本地读取</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 这里在api.js里面加了一个参数，控制是否需要传递鉴权</span></span><br><span class="line">    <span class="comment">// 当有requiresAuth且为true是加上鉴权</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      config.requiresAuth &amp;&amp;</span><br><span class="line">      config.requiresAuth === <span class="literal">true</span> &amp;&amp;</span><br><span class="line">      <span class="built_in">localStorage</span>.loginUserBaseInfo &amp;&amp;</span><br><span class="line">      <span class="built_in">JSON</span>.parse(<span class="built_in">localStorage</span>.loginUserBaseInfo).jwtCode</span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">let</span> token = <span class="built_in">JSON</span>.parse(<span class="built_in">localStorage</span>.loginUserBaseInfo).jwtCode;</span><br><span class="line">      config.headers.Authorization = token;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;config:&quot;</span>, config);</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// error 的回调信息</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;request:&quot;</span>, error);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回状态判断(添加响应拦截器)</span></span><br><span class="line">Axios.interceptors.response.use(</span><br><span class="line">  <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//对响应数据做些事</span></span><br><span class="line">    <span class="keyword">if</span> (res.data &amp;&amp; !(res.data.code === <span class="number">200</span>)) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;返回状态判断&quot;</span>);</span><br><span class="line">      <span class="comment">// console.log(&quot;res:&quot;, res);</span></span><br><span class="line">      alert(res.data.msg);</span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(res.data.msg);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;res:&quot;</span>, res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error &amp;&amp; error.response) &#123;</span><br><span class="line">      <span class="keyword">let</span> msg = error.response.data.msg;</span><br><span class="line">      <span class="keyword">switch</span> (error.response.status) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">          alert(<span class="string">&quot;请求错误：&quot;</span> + msg);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          alert(<span class="string">&quot;未经授权的&quot;</span> + msg);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">403</span>:</span><br><span class="line">          alert(<span class="string">&quot;拒绝访问&quot;</span> + msg);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">404</span>:</span><br><span class="line">          alert(<span class="string">&quot;请求地址出错&quot;</span> + msg);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">          alert(<span class="string">&quot;服务器内部错误&quot;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">          alert(<span class="string">&quot;错误&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;response:&quot;</span>, error.response);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error.response);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Axios;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里由于每次请求分到各个逻辑里面处理的话，代码不好管理，而且代码会很乱，工作量也大。这里把axios做一个二次封装，做一个请求和相应的统一拦截。</p>
<p>比如说很多请求（除了登录）都需要鉴权验证，在请求前做一个请求头统一加上Authorization。然后也可以设置一下统一的<code>Content-Type</code>，这里需要和后端协商一下，让他统一接收参数或者json。如果接收参数的话，也可以使用qs做一个统一序列化。</p>
<p>然后可以共同约定一下返回的错误code，然后把返回的code值根据约定作相应的处理，比如说401鉴权失败，然后重定向到<code>/login</code></p>
<p>然后也可以把接口统一封装一下，便于修改</p>
<p>然后如果想要在全局使用这个封装好的api，在main.js中引入api文件，然后使用<code>Vue.prototype.$api = api;</code>，(这里应该是把$api放到了Vue的原型上)，就可以在全局通过<code>this.$api</code>调用了</p>
<h2 id="JWT鉴权验证"><a href="#JWT鉴权验证" class="headerlink" title="JWT鉴权验证"></a>JWT鉴权验证</h2><p>JWT之前一直没用过，这次和后端用了一下，在前后端分离里面用的比较多吧。</p>
<p>那么鉴权验证的流程是什么呢？简单讲就是，前端用户登陆后，后端会返回一个token，然后前端把这个token存到localStorage或者session再或者Vuex里面管理，不同位置有不同的适用范围吧。考虑到session以及Vuex里面管理的话，刷新后就没有了，所以我存到了localStorage里面。</p>
<p>然后每次需要鉴权的时候（比如说这里面的查询就需要鉴权，但是登陆不需要鉴权），把token加到请求头里面，发给后端进行身份验证。然后后端返回code状态码，或者直接重定向什么的都行。</p>
<p>JWT按照我的理解主要用于签名验证，JWT分为三段，验证前两段编码后和第三段是否相同，即可判断是否是目标签名。</p>
<h3 id="具体的一些实现"><a href="#具体的一些实现" class="headerlink" title="具体的一些实现"></a>具体的一些实现</h3><h4 id="axios拦截"><a href="#axios拦截" class="headerlink" title="axios拦截"></a>axios拦截</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (</span><br><span class="line">  <span class="built_in">localStorage</span>.loginUserBaseInfo &amp;&amp;</span><br><span class="line">  <span class="built_in">JSON</span>.parse(<span class="built_in">localStorage</span>.loginUserBaseInfo).jwtCode</span><br><span class="line">) &#123;</span><br><span class="line">  <span class="keyword">let</span> token = <span class="built_in">JSON</span>.parse(<span class="built_in">localStorage</span>.loginUserBaseInfo).jwtCode;</span><br><span class="line">  config.headers.Authorization = token;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里我一开始把所有的请求都加上了token，这里就是做一个简单的判断，判断本地有没有保存token信息，保存的话就加到请求头里面。</p>
<p>但是后来有一个问题，那就是比如登录并不需要加上token，虽然后端没有判断，一开始并没有什么问题。但是当超过了过期时间之后，我发现登录的时候有莫名的报错，看了好半天才找到了这个问题。那就是后端应该是把这个鉴权统一处理了，那只能我这边来改。</p>
<p>解决方法，在封装过的api请求文件里面，多加上一个参数<code>requiresAuth</code>为<code>true</code>则表示需要鉴权。然后在axios拦截器里面多加上一个判断<code>config.requiresAuth &amp;&amp; config.requiresAuth === true</code>（<del>此处需要深入理解一下Promise和ajax的区别</del>）</p>
<p>Promise主要用于异步编程，和ajax并无联系，只不过是因为Promise用于ajax异步后，能解决回调地狱问题，更多实践查看<a href="/2019/02/18/js%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/">js异步编程</a></p>
<h4 id="vue-router全局导航守卫"><a href="#vue-router全局导航守卫" class="headerlink" title="vue-router全局导航守卫"></a>vue-router全局导航守卫</h4><p>这里每次跳转前都要做一个判断，就是判断当前是否有鉴权信息，以及是否过期</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue-router导航守卫，全局守卫</span></span><br><span class="line"><span class="comment">// 并不是所有页面请求都需要加上token，所以需要做一个全局守卫</span></span><br><span class="line"><span class="comment">// 在路由meta加一个字段requiresAuth,设置为true则必须加上鉴权</span></span><br><span class="line"><span class="comment">// 登录页不需要鉴权</span></span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 如果检测到meta含有字段</span></span><br><span class="line">  <span class="keyword">if</span> (to.matched.some(<span class="function"><span class="params">res</span> =&gt;</span> res.meta.requiresAuth)) &#123;</span><br><span class="line">    <span class="comment">// 检测是否有鉴权信息</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">localStorage</span>.loginUserBaseInfo) &#123;</span><br><span class="line">      <span class="keyword">let</span> lifeTime = <span class="built_in">JSON</span>.parse(<span class="built_in">localStorage</span>.loginUserBaseInfo).lifeTime;</span><br><span class="line">      <span class="keyword">let</span> nowTime = <span class="keyword">new</span> <span class="built_in">Date</span>().getTime();</span><br><span class="line">      <span class="comment">// 比较当前时间和过期时间</span></span><br><span class="line">      <span class="keyword">if</span> (nowTime &lt; lifeTime) &#123;</span><br><span class="line">        <span class="comment">// 有鉴权信息而且未过期</span></span><br><span class="line">        next();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 鉴权已过期，跳转到登录页</span></span><br><span class="line">        alert(<span class="string">&quot;登录状态过期，请重新登录&quot;</span>);</span><br><span class="line">        next(&#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 没有鉴权信息，跳转到登录页</span></span><br><span class="line">      alert(<span class="string">&quot;登录状态过期，请重新登录&quot;</span>);</span><br><span class="line">      next(&#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&quot;/login&quot;</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 无需鉴权信息，继续</span></span><br><span class="line">    next();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>由于后端返回的过期时间是时间段，所以这里判断过期采用的方法是，login登录后获取的过期时间加上<code>getTime()</code>，得到过期时间戳存入localStrage。然后在路由处设置meta字段，来控制路由跳转时是否需要鉴权判断过期时间，如果过期，直接跳转到<code>/login</code>。</p>
<h2 id="二进制流文件下载"><a href="#二进制流文件下载" class="headerlink" title="二进制流文件下载"></a>二进制流文件下载</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(response.headers);</span><br><span class="line"><span class="keyword">let</span> content = response.data;</span><br><span class="line"><span class="keyword">let</span> blob = <span class="keyword">new</span> Blob([content]);</span><br><span class="line"><span class="keyword">let</span> fileName = response.headers[<span class="string">&quot;content-disposition&quot;</span>].split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&quot;download&quot;</span> <span class="keyword">in</span> <span class="built_in">document</span>.createElement(<span class="string">&quot;a&quot;</span>)) &#123;</span><br><span class="line">  <span class="comment">// 非IE下载</span></span><br><span class="line">  <span class="keyword">let</span> elink = <span class="built_in">document</span>.createElement(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">  elink.download = fileName;</span><br><span class="line">  elink.style.display = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">  elink.href = URL.createObjectURL(blob);</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(elink);</span><br><span class="line">  elink.click();</span><br><span class="line">  URL.revokeObjectURL(elink.href);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// IE 10+ 下载</span></span><br><span class="line">  navigator.msSaveBlob(blob, fileName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里后端传我的是二进制流，虽然之前写的项目也是这样处理的，但是一个是当时没有认真研究，而且当时没有使用axios，导致这次也卡了一小段时间。</p>
<p>然后就是Blob对象，Blob 对象表示一个不可变、原始数据的类文件对象。这里创建了一个文本节点，并隐藏，触发点击事件，触发下载。而且需要把api封装的接口设置<code>responseType: &quot;blob&quot;</code>。</p>
<p>这里获取的是excel文件，后端通过<code>Content-Disposition</code>把文件名返回给我，这里其实有一个问题。虽然从network里面分析到了该请求头，但是axios并没有拦截到该请求头，这里需要后端设置<code>Access-Control-Expose-Headers</code>才能获取到该请求头。</p>
<p>但是目前有一个问题还没有解决，那就是后端直接返回我的是<code>data: Blob()</code>，似乎是不能再多返回一个code状态码？没有状态码的话，我前面axios的拦截就不能统一根据返回的code来采取不同的处理。<del>这里暂时没有解决，后面需要尝试写一下后端研究一下。</del></p>
<p>解决方案：直接判断返回类型，如果返回的是Blob型，直接另一套操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (res.data &amp;&amp; !(res.data <span class="keyword">instanceof</span> Blob) &amp;&amp; !(res.data.code === <span class="number">200</span>))</span><br></pre></td></tr></table></figure>

<h2 id="将共同方法抽离"><a href="#将共同方法抽离" class="headerlink" title="将共同方法抽离"></a>将共同方法抽离</h2><p>情景：左侧过滤，翻页，页面跳转，排序四处操作都需要发送查询结果的请求，其返回结果都差不多，只是参数数量和数据不同。根据不同模块，其调用接口不相同，而且每处操作有略微不同，这是抽离的难处。但是，每次改动后，都需要将这些方法逐个修改，代码可维护性极差，因此，将其抽离出来势在必行。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;@/store/index&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">&quot;@/request/api&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取ESI期刊的方法抽离</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 传入两个参数，一个是一级目录名，一个是二级目录名</span></span><br><span class="line"><span class="comment"> * 这里两个api接口的传过去的参数不同，但是获取数据后的操作相同</span></span><br><span class="line"><span class="comment"> * 所以用if判断了二级目录</span></span><br><span class="line"><span class="comment"> * 在全期下是一个接口</span></span><br><span class="line"><span class="comment"> * 在当期，当期新增，当期跌出是一个接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">firDirectory</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;*&#125;</span> <span class="variable">secDirectory</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getEsi = <span class="function">(<span class="params">firDirectory, secDirectory</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (firDirectory === <span class="string">&quot;periodical&quot;</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果当前在esi期刊目录下</span></span><br><span class="line">    <span class="keyword">if</span> (secDirectory === <span class="string">&quot;all&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// 如果在全期</span></span><br><span class="line">      <span class="comment">// 获取数据</span></span><br><span class="line">      api.search</span><br><span class="line">        .searchAll()</span><br><span class="line">        .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(response.data.data);</span><br><span class="line">          <span class="comment">// ES6变量解构</span></span><br><span class="line">          <span class="keyword">let</span> &#123; totalElemNums, data &#125; = response.data.data;</span><br><span class="line">          <span class="keyword">let</span> articleTotal = totalElemNums;</span><br><span class="line">          <span class="keyword">let</span> articleList = data;</span><br><span class="line">          <span class="comment">// map遍历文章数组，取出esiId属性重新组成数组</span></span><br><span class="line">          <span class="keyword">let</span> checkedArr = articleList.map(<span class="function"><span class="params">obj</span> =&gt;</span> obj.esiId);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 提交文章数量和文章列表</span></span><br><span class="line">          store.dispatch(<span class="string">&quot;getArticleTotal&quot;</span>, articleTotal);</span><br><span class="line">          store.dispatch(<span class="string">&quot;getArticleListList&quot;</span>, articleList);</span><br><span class="line">          <span class="comment">// 提交文章id数组</span></span><br><span class="line">          store.dispatch(<span class="string">&quot;getCheckedArr&quot;</span>, checkedArr);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 初始化Vuex中的checkedId</span></span><br><span class="line">          store.dispatch(<span class="string">&quot;getCheckedId&quot;</span>, []);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 在esi模块的其它栏目下</span></span><br><span class="line">      <span class="keyword">const</span> periodicalTimeTxt = &#123;</span><br><span class="line">        <span class="attr">current</span>: <span class="string">&quot;current&quot;</span>,</span><br><span class="line">        <span class="attr">new</span>: <span class="string">&quot;newAddition&quot;</span>,</span><br><span class="line">        <span class="attr">decrease</span>: <span class="string">&quot;fellOut&quot;</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="built_in">console</span>.log(periodicalTimeTxt[secDirectory]);</span><br><span class="line">      <span class="comment">// 获取数据</span></span><br><span class="line">      api.search</span><br><span class="line">        .searchCurrent(periodicalTimeTxt[secDirectory])</span><br><span class="line">        .then(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// ES6变量解构</span></span><br><span class="line">          <span class="keyword">let</span> &#123; totalElemNums, data &#125; = response.data.data;</span><br><span class="line">          <span class="keyword">let</span> articleTotal = totalElemNums;</span><br><span class="line">          <span class="keyword">let</span> articleList = data;</span><br><span class="line">          <span class="comment">// map遍历文章数组，取出esiId属性重新组成数组</span></span><br><span class="line">          <span class="keyword">let</span> checkedArr = articleList.map(<span class="function"><span class="params">obj</span> =&gt;</span> obj.esiId);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 提交文章数量和文章列表</span></span><br><span class="line">          store.dispatch(<span class="string">&quot;getArticleTotal&quot;</span>, articleTotal);</span><br><span class="line">          store.dispatch(<span class="string">&quot;getArticleListList&quot;</span>, articleList);</span><br><span class="line">          <span class="comment">// 提交文章id数组</span></span><br><span class="line">          store.dispatch(<span class="string">&quot;getCheckedArr&quot;</span>, checkedArr);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 初始化Vuex中的checkedId</span></span><br><span class="line">          store.dispatch(<span class="string">&quot;getCheckedId&quot;</span>, []);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>上面只是列举了期刊的处理办法，由于模块不同，分为两级栏目，因此函数设置了两个参数，一个是一级栏目，一个是二级栏目。根据栏目不同调用不同的处理办法。</p>
<p>其中需要管理vuex，以及调用封装好的api请求接口，因此将这两模块引入，然后在每一处需要使用该方法的地方<code>import</code>导入，根据不同情况调用该方法即可。</p>
<h2 id="Vue插件形式扩展一个全局组件"><a href="#Vue插件形式扩展一个全局组件" class="headerlink" title="Vue插件形式扩展一个全局组件"></a>Vue插件形式扩展一个全局组件</h2><p>情景：需要做一个类似iview或者element-ui里面的一个全局提示组件，因为alert弹出提示太丑了，该组件多在ajax回调中使用，来显示请求结果成功或者失败</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">&quot;fade&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;type&quot;</span> <span class="attr">v-show</span>=<span class="string">&quot;show&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-if</span>=<span class="string">&quot;type === &#x27;info&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-info-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else-if</span>=<span class="string">&quot;type === &#x27;success&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-check-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else-if</span>=<span class="string">&quot;type === &#x27;error&#x27;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;fa fa-times-circle&quot;</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>        </span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>&#123;&#123;text&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> VueMessage = Vue.extend(&#123;</span><br><span class="line">  <span class="function"><span class="title">render</span>(<span class="params">h</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> props = &#123;</span><br><span class="line">      type,</span><br><span class="line">      <span class="attr">text</span>: msg,</span><br><span class="line">      <span class="attr">show</span>: <span class="built_in">this</span>.show</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// return h(&quot;Message&quot;, &#123; props: props &#125;);</span></span><br><span class="line">    <span class="comment">// ES6简写</span></span><br><span class="line">    <span class="keyword">return</span> h(<span class="string">&quot;Message&quot;</span>, &#123; props &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">show</span>: <span class="literal">false</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">let</span> newMessage = <span class="keyword">new</span> VueMessage();</span><br><span class="line"><span class="keyword">let</span> vm = newMessage.$mount();</span><br><span class="line"><span class="built_in">console</span>.log(vm);</span><br><span class="line"><span class="keyword">let</span> el = vm.$el;</span><br><span class="line"><span class="built_in">console</span>.log(el);</span><br><span class="line"><span class="built_in">document</span>.body.appendChild(el); <span class="comment">// 把生成的提示的dom插入body中</span></span><br></pre></td></tr></table></figure>

<p>该组件代码参考了一片文章。只贴了一部分代码。首先，开发插件要使用Vue公开方法<code>install</code>，然后使用了<code>Vue.extend()</code>创建一个子类，后面的Message组件都是以实例化该类形成的，<code>extend()</code>return的参数可以参照Vue官方文档，作者这里使用<code>render()</code>而并未使用<code>template</code>暂时没看明白原因。不过直接使用template也不会有错。</p>
<p>后面就是要先将实例化对象挂载到DOM上，然后通过$el来访问DOM。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 添加到window上，暴露三个方法（可以在js文件里直接调用）</span></span><br><span class="line"><span class="built_in">window</span>.$message = &#123;</span><br><span class="line">  <span class="function"><span class="title">info</span>(<span class="params">text, callBack</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!text) <span class="keyword">return</span>;</span><br><span class="line">    msg(<span class="string">&quot;info&quot;</span>, text, callBack);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">success</span>(<span class="params">text, callBack</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!text) <span class="keyword">return</span>;</span><br><span class="line">    msg(<span class="string">&quot;success&quot;</span>, text, callBack);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">error</span>(<span class="params">text, callBack</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!text) <span class="keyword">return</span>;</span><br><span class="line">    msg(<span class="string">&quot;error&quot;</span>, text, callBack);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>还要提一点，因为我把axios二次封装，所以请求回调都没有写在vue文件里面，而是写在了抽离出来的js文件，因此无法通过Vue组件来调用。因此我将方法也同样添加到了到了window上，暴露了三个方法，然后在js文件中直接使用<code>window.$message.error(msg);</code>来调用。</p>
<p>虽然不知道合不合理，但是确实解决了这一问题。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>论文查询平台</p><p><a href="http://example.com/论文查询平台/">http://example.com/论文查询平台/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>xiaoqi</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2018-12-02</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-09-30</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E9%A1%B9%E7%9B%AE/">项目</a><a class="link-muted mr-2" rel="tag" href="/tags/Vue/">Vue</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">¿Te gusta este artículo? Apoya al autor con</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Cómprame un café</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/%E5%86%85%E8%81%94%E5%85%83%E7%B4%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8E%A2%E7%A9%B6/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">内联元素的一些探究</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/css%E7%BB%98%E5%88%B6%E4%B8%89%E9%81%93%E6%9D%A0%E5%92%8C%E5%B0%8F%E5%9C%86%E7%82%B9/"><span class="level-item">CSS绘制三道杠和小圆点</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comentarios</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://www.gravatar.com/avatar/befd755a232737f046d80d84ae5ce82f?s=128" alt="xiaoqi"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">xiaoqi</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ShenZhen</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Entradas</p><a href="/archives"><p class="title">33</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categorías</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Etiquetas</p><a href="/tags"><p class="title">24</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Qxiaoqi" target="_blank" rel="noopener">SEGUIR</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Qxiaoqi"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categorías</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/PS/"><span class="level-start"><span class="level-item">PS</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/hexo/"><span class="level-start"><span class="level-item">hexo</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%89%8D%E7%AB%AF/"><span class="level-start"><span class="level-item">前端</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%9B%BE%E5%BD%A2%E5%AD%A6/"><span class="level-start"><span class="level-item">图形学</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%80%BB%E7%BB%93/"><span class="level-start"><span class="level-item">总结</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">项目</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recientes</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-10-11T13:50:21.000Z">2021-10-11</time></p><p class="title"><a href="/hexo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%88%E4%BA%8C%EF%BC%89/">hexo源码分析（二）</a></p><p class="categories"><a href="/categories/hexo/">hexo</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-30T03:50:21.000Z">2021-09-30</time></p><p class="title"><a href="/hexo%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%EF%BC%88%E4%B8%80%EF%BC%89/">hexo源码分析（一）</a></p><p class="categories"><a href="/categories/hexo/">hexo</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-29T03:50:21.000Z">2021-09-29</time></p><p class="title"><a href="/%E6%94%B9%E9%80%A0icarus%E5%8D%9A%E5%AE%A2%E4%B8%BB%E9%A2%98%EF%BC%88%E4%B8%80%EF%BC%89/">改造icarus博客主题（一）</a></p><p class="categories"><a href="/categories/hexo/">hexo</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-09-28T03:53:29.000Z">2021-09-28</time></p><p class="title"><a href="/%E8%99%9A%E5%81%87%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/">虚假的第一篇博客</a></p><p class="categories"><a href="/categories/%E6%80%BB%E7%BB%93/">总结</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-05-07T08:18:19.000Z">2020-05-07</time></p><p class="title"><a href="/%E6%B5%8F%E8%A7%88%E5%99%A8%E9%87%8D%E7%BB%98%E5%92%8Crequestanimationframe/">浏览器重绘和requestAnimationFrame</a></p><p class="categories"><a href="/categories/%E5%89%8D%E7%AB%AF/">前端</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Etiquetas</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/CSS/"><span class="tag">CSS</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Express/"><span class="tag">Express</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JS/"><span class="tag">JS</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MySQL/"><span class="tag">MySQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/P5JS/"><span class="tag">P5JS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PS/"><span class="tag">PS</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Promise/"><span class="tag">Promise</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vue/"><span class="tag">Vue</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cli/"><span class="tag">cli</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ejs/"><span class="tag">ejs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gulp/"><span class="tag">gulp</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jQuery/"><span class="tag">jQuery</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/npm/"><span class="tag">npm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vue/"><span class="tag">vue</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/webpack/"><span class="tag">webpack</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BC%98%E5%8C%96/"><span class="tag">优化</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/"><span class="tag">图形学</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%80%A7%E8%83%BD/"><span class="tag">性能</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%80%BB%E7%BB%93/"><span class="tag">总结</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"><span class="tag">浏览器</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%BA%90%E7%A0%81/"><span class="tag">源码</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%A1%B9%E7%9B%AE/"><span class="tag">项目</span><span class="tag">6</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catálogo</h3><ul class="menu-list"><li><a class="level is-mobile" href="#大概需求"><span class="level-left"><span class="level-item">1</span><span class="level-item">大概需求</span></span></a></li><li><a class="level is-mobile" href="#结构设计"><span class="level-left"><span class="level-item">2</span><span class="level-item">结构设计</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#组件抽象"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">组件抽象</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#左侧过滤组件"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">左侧过滤组件</span></span></a></li></ul></li><li><a class="level is-mobile" href="#vuex数据管理"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">vuex数据管理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#关于css"><span class="level-left"><span class="level-item">3</span><span class="level-item">关于css</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#css嵌套问题"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">css嵌套问题</span></span></a></li><li><a class="level is-mobile" href="#将less的全局变量文件抽离"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">将less的全局变量文件抽离</span></span></a></li></ul></li><li><a class="level is-mobile" href="#axios二次封装"><span class="level-left"><span class="level-item">4</span><span class="level-item">axios二次封装</span></span></a></li><li><a class="level is-mobile" href="#JWT鉴权验证"><span class="level-left"><span class="level-item">5</span><span class="level-item">JWT鉴权验证</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#具体的一些实现"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">具体的一些实现</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#axios拦截"><span class="level-left"><span class="level-item">5.1.1</span><span class="level-item">axios拦截</span></span></a></li><li><a class="level is-mobile" href="#vue-router全局导航守卫"><span class="level-left"><span class="level-item">5.1.2</span><span class="level-item">vue-router全局导航守卫</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#二进制流文件下载"><span class="level-left"><span class="level-item">6</span><span class="level-item">二进制流文件下载</span></span></a></li><li><a class="level is-mobile" href="#将共同方法抽离"><span class="level-left"><span class="level-item">7</span><span class="level-item">将共同方法抽离</span></span></a></li><li><a class="level is-mobile" href="#Vue插件形式扩展一个全局组件"><span class="level-left"><span class="level-item">8</span><span class="level-item">Vue插件形式扩展一个全局组件</span></span></a></li></ul></div></div><script src="/js/toc.js" defer></script></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Xiaoqi&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 xiaoqi</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-Hans");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="Volver arriba" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "Este sitio web utiliza cookies para mejorar su experiencia.",
          dismiss: "¡Entendido!",
          allow: "Permitir cookies",
          deny: "Descenso",
          link: "Aprende más",
          policy: "Política de cookies",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Teclea algo..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Teclea algo...","untitled":"(Sin título)","posts":"Entradas","pages":"Páginas","categories":"Categorías","tags":"Etiquetas"});
        });</script></body></html>